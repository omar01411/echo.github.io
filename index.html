<!DOCTYPE html>
<html>
  <head>
    <base href="./" />

    <meta charset="UTF-8" />
    <meta content="IE=Edge" http-equiv="X-UA-Compatible" />
    <meta name="description" content="Echo App" />

    <!-- iOS meta tags & icons -->
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black" />
    <meta name="apple-mobile-web-app-title" content="glcecho" />
    <link rel="apple-touch-icon" href="icons/Icon-192.png" />

    <!-- Favicon -->
    <link rel="icon" type="image/png" href="favicon.png" />

    <title>glcecho</title>
    <link rel="manifest" href="manifest.json" />
  </head>

  <body>
    <script>
      window.addEventListener('load', function(ev) {
        // The _flutter.loader is available from flutter_bootstrap.js
        if (typeof _flutter !== 'undefined' && _flutter.loader) {
          _flutter.loader.load({
            serviceWorkerSettings: {
              serviceWorkerVersion: serviceWorkerVersion,
            },
            onEntrypointLoaded: function(engineInitializer) {
              engineInitializer.initializeEngine().then(function(appRunner) {
                appRunner.runApp();
                // Delayed Firebase service worker registration (after framework ready)
                if ('serviceWorker' in navigator) {
                  navigator.serviceWorker.register('/firebase-messaging-sw.js')
                    .then(reg => console.log('Firebase SW (delayed) scope:', reg.scope))
                    .catch(err => console.error('Firebase SW registration failed:', err));
                }
              });
            }
          });
        } else {
          console.error('Flutter loader not available');
        }
      });
    </script>

    <script src="flutter_bootstrap.js" async></script>
  </body>
</html>
